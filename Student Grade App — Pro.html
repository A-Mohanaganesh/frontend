<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Student Grade App — Pro</title>
  <link rel="stylesheet" href="style.css">
   <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- Chart.js CDN -->
  <style>
    /* Reset & Base */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
  font-family: 'Segoe UI', sans-serif;
}

body {
  background-color: #f5f5f5;
  color: #333;
  transition: background-color 0.3s, color 0.3s;
}

.app {
  max-width: 1200px;
  margin: 0 auto;
  padding: 20px;
}

/* Topbar */
.topbar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.topbar h1 {
  font-size: 1.8rem;
}

.controls {
  display: flex;
  align-items: center;
  gap: 10px;
}

/* Dark mode switch */
.switch {
  position: relative;
  display: inline-block;
  width: 50px;
  height: 24px;
}

.switch input {
  display: none;
}

.slider {
  position: absolute;
  cursor: pointer;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background-color: #ccc;
  transition: 0.4s;
  border-radius: 24px;
}

.slider:before {
  position: absolute;
  content: "";
  height: 18px;
  width: 18px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  transition: 0.4s;
  border-radius: 50%;
}

input:checked + .slider {
  background-color: #2196F3;
}

input:checked + .slider:before {
  transform: translateX(26px);
}

/* Main Grid */
.main-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 20px;
}

.card {
  background-color: #fff;
  padding: 20px;
  border-radius: 12px;
  box-shadow: 0 3px 10px rgba(0,0,0,0.1);
  transition: background-color 0.3s, color 0.3s;
}

/* Form inputs */
input[type="text"] {
  width: 100%;
  padding: 10px;
  margin: 8px 0;
  border-radius: 6px;
  border: 1px solid #ccc;
}

/* Buttons */
button {
  padding: 10px 16px;
  border: none;
  border-radius: 6px;
  background-color: #2196F3;
  color: white;
  cursor: pointer;
  transition: background-color 0.3s;
}

button:hover {
  background-color: #0b7dda;
}

button.danger {
  background-color: #f44336;
}

button.danger:hover {
  background-color: #c0392b;
}

.row {
  display: flex;
  gap: 10px;
  margin-top: 10px;
}

/* Result Box */
.resultBox {
  margin-top: 20px;
}

.avgRow, .gradeRow, .passRow {
  display: flex;
  justify-content: space-between;
  margin-top: 8px;
}

.progressWrap {
  margin-top: 15px;
}

.progressLabel {
  font-weight: bold;
  margin-bottom: 5px;
}

.progressBar {
  width: 100%;
  height: 20px;
  background-color: #eee;
  border-radius: 10px;
  overflow: hidden;
}

.progressFill {
  width: 0%;
  height: 100%;
  background-color: #2196F3;
  border-radius: 10px;
  transition: width 0.5s;
}

.progressPercent {
  text-align: right;
  margin-top: 5px;
  font-weight: bold;
}

/* History Table */
.tableWrap {
  overflow-x: auto;
}

table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
  text-align: left;
  padding: 8px;
  border-bottom: 1px solid #ddd;
}

/* Footer */
.footer {
  text-align: center;
  margin-top: 30px;
  font-size: 0.9rem;
  color: #777;
}

/* Dark mode */
body.dark {
  background-color: #121212;
  color: #e0e0e0;
}

body.dark .card {
  background-color: #1e1e1e;
}

body.dark input[type="text"] {
  background-color: #2c2c2c;
  border: 1px solid #555;
  color: #e0e0e0;
}

body.dark table th, body.dark table td {
  border-bottom: 1px solid #444;
}
  </style>
</head>
<body>
  <div class="app">
    <header class="topbar">
      <h1>🎓 Student Grade App — Pro</h1>
      <div class="controls">
        <label class="switch">
          <input type="checkbox" id="themeToggle" />
          <span class="slider"></span>
        </label>
        <span class="theme-label">Dark</span>
      </div>
    </header>

    <main class="main-grid">
      <section class="card form-card">
        <h2>Add Student</h2>
        <input id="name" type="text" placeholder="Student name" />
        <input id="marks" type="text" placeholder="Marks (comma separated) e.g. 78, 90, 55" />
        <div class="row">
          <button id="calcBtn">Calculate</button>
          <button id="saveBtn">Save Result</button>
        </div>

        <div class="resultBox" id="resultBox">
          <h3 id="resName"></h3>
          <div class="avgRow">
            <div class="avgLabel">Average:</div>
            <div class="avgValue" id="avgValue">—</div>
          </div>
          <div class="gradeRow">
            <div class="gradeLabel">Grade:</div>
            <div class="gradeValue" id="gradeValue">—</div>
          </div>
          <div class="passRow">
            <div id="passMsg"></div>
          </div>

          <div class="progressWrap">
            <div class="progressLabel">Progress</div>
            <div class="progressBar" id="progressBar">
              <div class="progressFill" id="progressFill"></div>
            </div>
            <div class="progressPercent" id="progressPercent">0%</</div>
          </div>

          <canvas id="marksChart" width="200" height="200"></canvas>
        </div>
      </section>

      <section class="card history-card">
        <h2>Saved Students</h2>
        <div class="history-controls">
          <button id="clearBtn" class="danger">Clear History</button>
          <button id="exportBtn">Export JSON</button>
        </div>
        <div class="tableWrap">
          <table id="historyTable">
            <thead>
              <tr><th>#</th><th>Name</th><th>Avg</th><th>Grade</th><th>Pass</th><th>When</th><th>Action</th></tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </section>
    </main>

    <footer class="footer">
      <small>Pro version — Responsive + LocalStorage + Dark Mode + Chart + Progress Bar</small>
    </footer>
  </div>

  <script src="script.js"></script>
  <script>
    // DOM Elements
const nameInput = document.getElementById('name');
const marksInput = document.getElementById('marks');
const calcBtn = document.getElementById('calcBtn');
const saveBtn = document.getElementById('saveBtn');
const resultBox = document.getElementById('resultBox');
const resName = document.getElementById('resName');
const avgValue = document.getElementById('avgValue');
const gradeValue = document.getElementById('gradeValue');
const passMsg = document.getElementById('passMsg');
const progressFill = document.getElementById('progressFill');
const progressPercent = document.getElementById('progressPercent');
const marksChart = document.getElementById('marksChart');

const historyTableBody = document.querySelector('#historyTable tbody');
const clearBtn = document.getElementById('clearBtn');
const exportBtn = document.getElementById('exportBtn');

const themeToggle = document.getElementById('themeToggle');

// Initialize chart
let chart = new Chart(marksChart, {
    type: 'bar',
    data: {
        labels: [],
        datasets: [{
            label: 'Marks',
            data: [],
            backgroundColor: '#2196F3'
        }]
    },
    options: {
        responsive: true,
        scales: { y: { beginAtZero: true, max: 100 } }
    }
});

// Functions
function calculateAverage(marks) {
    const total = marks.reduce((a,b)=>a+b,0);
    return (total / marks.length).toFixed(2);
}

function getGrade(avg) {
    if(avg >= 90) return 'A';
    if(avg >= 80) return 'B';
    if(avg >= 70) return 'C';
    if(avg >= 60) return 'D';
    return 'F';
}

function getPassMessage(grade) {
    return ['A','B','C','D'].includes(grade) ? '✅ Pass' : '❌ Fail';
}

function updateProgressBar(avg) {
    progressFill.style.width = `${avg}%`;
    progressPercent.textContent = `${avg}%`;
}

function updateChart(marks) {
    chart.data.labels = marks.map((_,i)=>`Subj ${i+1}`);
    chart.data.datasets[0].data = marks;
    chart.update();
}

function saveStudent(student) {
    const students = JSON.parse(localStorage.getItem('students') || '[]');
    students.push(student);
    localStorage.setItem('students', JSON.stringify(students));
    renderHistory();
}

function renderHistory() {
    const students = JSON.parse(localStorage.getItem('students') || '[]');
    historyTableBody.innerHTML = '';
    students.forEach((s, idx) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${idx+1}</td>
            <td>${s.name}</td>
            <td>${s.avg}</td>
            <td>${s.grade}</td>
            <td>${s.pass}</td>
            <td>${s.date}</td>
            <td><button onclick="deleteStudent(${idx})">Delete</button></td>
        `;
        historyTableBody.appendChild(row);
    });
}

function deleteStudent(idx) {
    const students = JSON.parse(localStorage.getItem('students') || '[]');
    students.splice(idx,1);
    localStorage.setItem('students', JSON.stringify(students));
    renderHistory();
}

// Event Listeners
calcBtn.addEventListener('click', () => {
    const name = nameInput.value.trim();
    const marksArr = marksInput.value.split(',').map(m=>parseFloat(m.trim())).filter(m=>!isNaN(m));
    if(!name || marksArr.length===0) return alert('Please enter valid name and marks.');
    
    const avg = calculateAverage(marksArr);
    const grade = getGrade(avg);
    const pass = getPassMessage(grade);

    resName.textContent = name;
    avgValue.textContent = avg;
    gradeValue.textContent = grade;
    passMsg.textContent = pass;

    updateProgressBar(avg);
    updateChart(marksArr);
});

saveBtn.addEventListener('click', () => {
    const name = resName.textContent;
    const avg = avgValue.textContent;
    const grade = gradeValue.textContent;
    const pass = passMsg.textContent;
    if(!name) return alert('Calculate first before saving.');
    
    const student = {
        name, avg, grade, pass,
        date: new Date().toLocaleString()
    };
    saveStudent(student);
});

// History controls
clearBtn.addEventListener('click', () => {
    if(confirm('Clear all history?')) {
        localStorage.removeItem('students');
        renderHistory();
    }
});

exportBtn.addEventListener('click', () => {
    const students = JSON.parse(localStorage.getItem('students') || '[]');
    const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(students, null, 2));
    const a = document.createElement('a');
    a.href = dataStr;
    a.download = 'students.json';
    a.click();
});

// Theme toggle
themeToggle.addEventListener('change', () => {
    document.body.classList.toggle('dark', themeToggle.checked);
});

// Initial render
renderHistory();
  </script>
</body>
</html>